module Saint
  class Vulnerability
    def initialize(xml_node)
      @xml = xml_node
    end

    def supported_tags
      [
        :description, :hostname, :ipaddr, :hosttype, :scan_time, :status,
        :severity, :cve, :cvss_base_score, :impact, :background, :problem,
        :resolution, :reference, :vuln_details
      ]
    end

    def respond_to?(method, include_private=false)
      return true if supported_tags.include?(method.to_sym)
      super
    end

    def method_missing(method, *args)
      unless supported_tags.include?(method)
        super
        return
      end

      field_tag = @xml.xpath("./#{method.to_s}").first
      field_tag ? field_tag.text : nil
    end
  end
end
